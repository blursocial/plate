{"version":3,"file":"index.js","sources":["../src/ColorPicker/ColorPicker.tsx","../src/ToolbarColorPicker/ToolbarColorPicker.tsx"],"sourcesContent":["import React from 'react';\nimport tw from 'twin.macro';\n\nexport const ColorPicker = ({\n  color,\n  updateColor,\n}: {\n  color: string | undefined;\n  updateColor: (ev: any, colorObj: string) => void;\n}) => {\n  return (\n    <div css={tw`flex`}>\n      <input\n        type=\"color\"\n        onChange={(ev) => updateColor(ev, ev.target.value)}\n        value={color || '#000000'}\n      />\n    </div>\n  );\n};\n","import React, {\n  ReactNode,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from 'react';\nimport { getMark, isMarkActive, setMarks } from '@udecode/plate-common';\nimport {\n  getPlatePluginType,\n  useEventEditorId,\n  useStoreEditorRef,\n  useStoreEditorSelection,\n  useStoreEditorState,\n} from '@udecode/plate-core';\nimport { ToolbarButton, ToolbarDropdown } from '@udecode/plate-toolbar';\nimport { BaseSelection, Transforms } from 'slate';\nimport { ReactEditor } from 'slate-react';\nimport { ColorPicker } from '../ColorPicker/ColorPicker';\n\nexport const ToolbarColorPicker = ({\n  pluginKey,\n  icon,\n}: {\n  pluginKey?: string;\n  icon: ReactNode;\n}) => {\n  const editor = useStoreEditorState(useEventEditorId('focus'));\n  const editorRef = useStoreEditorRef(useEventEditorId('focus'));\n  const selection = useStoreEditorSelection(useEventEditorId('focus'));\n  const type = getPlatePluginType(editor, pluginKey);\n\n  const color = editorRef && getMark(editorRef, type);\n\n  const [selectedColor, setSelectedColor] = useState<string>();\n\n  const latestSelection = useRef<BaseSelection>();\n\n  const updateColor = useCallback((ev: any, colorParam: string) => {\n    setSelectedColor(colorParam);\n  }, []);\n\n  useEffect(() => {\n    if (selection) {\n      latestSelection.current = selection;\n      setSelectedColor(color);\n    }\n  }, [color, selection]);\n\n  return (\n    <ToolbarDropdown\n      control={\n        <ToolbarButton\n          active={!!editor?.selection && isMarkActive(editor, type)}\n          icon={icon}\n        />\n      }\n      onClose={(e: MouseEvent) => {\n        if (editorRef && editor && latestSelection.current) {\n          e.preventDefault();\n\n          Transforms.select(editorRef, latestSelection.current);\n          ReactEditor.focus(editorRef);\n\n          if (selectedColor) {\n            setMarks(editor, { [type]: selectedColor });\n          }\n        }\n      }}\n    >\n      <ColorPicker color={selectedColor || color} updateColor={updateColor} />\n    </ToolbarDropdown>\n  );\n};\n"],"names":["ColorPicker","color","updateColor","React","ev","target","value","ToolbarColorPicker","pluginKey","icon","editor","useStoreEditorState","useEventEditorId","editorRef","useStoreEditorRef","selection","useStoreEditorSelection","type","getPlatePluginType","getMark","selectedColor","setSelectedColor","useState","latestSelection","useRef","useCallback","colorParam","useEffect","current","ToolbarDropdown","ToolbarButton","isMarkActive","e","preventDefault","Transforms","select","ReactEditor","focus","setMarks"],"mappings":";;;;;;;;;;;;;;;;;MAGaA,WAAW,GAAG,CAAC;AAC1BC,EAAAA,KAD0B;AAE1BC,EAAAA;AAF0B,CAAD,KAMrB;AACJ,sBACEC,uEACEA;AACE,IAAA,IAAI,EAAC,OADP;AAEE,IAAA,QAAQ,EAAGC,EAAD,IAAQF,WAAW,CAACE,EAAD,EAAKA,EAAE,CAACC,MAAH,CAAUC,KAAf,CAF/B;AAGE,IAAA,KAAK,EAAEL,KAAK,IAAI;AAHlB,IADF,CADF;AASD;;;;;GARe;AAAA;AAAA;;MCSHM,kBAAkB,GAAG,CAAC;AACjCC,EAAAA,SADiC;AAEjCC,EAAAA;AAFiC,CAAD,KAM5B;AACJ,QAAMC,MAAM,GAAGC,6BAAmB,CAACC,0BAAgB,CAAC,OAAD,CAAjB,CAAlC;AACA,QAAMC,SAAS,GAAGC,2BAAiB,CAACF,0BAAgB,CAAC,OAAD,CAAjB,CAAnC;AACA,QAAMG,SAAS,GAAGC,iCAAuB,CAACJ,0BAAgB,CAAC,OAAD,CAAjB,CAAzC;AACA,QAAMK,IAAI,GAAGC,4BAAkB,CAACR,MAAD,EAASF,SAAT,CAA/B;AAEA,QAAMP,KAAK,GAAGY,SAAS,IAAIM,mBAAO,CAACN,SAAD,EAAYI,IAAZ,CAAlC;AAEA,QAAM,CAACG,aAAD,EAAgBC,gBAAhB,IAAoCC,cAAQ,EAAlD;AAEA,QAAMC,eAAe,GAAGC,YAAM,EAA9B;AAEA,QAAMtB,WAAW,GAAGuB,iBAAW,CAAC,CAACrB,EAAD,EAAUsB,UAAV,KAAiC;AAC/DL,IAAAA,gBAAgB,CAACK,UAAD,CAAhB;AACD,GAF8B,EAE5B,EAF4B,CAA/B;AAIAC,EAAAA,eAAS,CAAC,MAAM;AACd,QAAIZ,SAAJ,EAAe;AACbQ,MAAAA,eAAe,CAACK,OAAhB,GAA0Bb,SAA1B;AACAM,MAAAA,gBAAgB,CAACpB,KAAD,CAAhB;AACD;AACF,GALQ,EAKN,CAACA,KAAD,EAAQc,SAAR,CALM,CAAT;AAOA,sBACEZ,wCAAC0B,4BAAD;AACE,IAAA,OAAO,eACL1B,wCAAC2B,0BAAD;AACE,MAAA,MAAM,EAAE,CAAC,EAACpB,MAAD,aAACA,MAAD,eAACA,MAAM,CAAEK,SAAT,CAAD,IAAuBgB,wBAAY,CAACrB,MAAD,EAASO,IAAT,CAD7C;AAEE,MAAA,IAAI,EAAER;AAFR,MAFJ;AAOE,IAAA,OAAO,EAAGuB,CAAD,IAAmB;AAC1B,UAAInB,SAAS,IAAIH,MAAb,IAAuBa,eAAe,CAACK,OAA3C,EAAoD;AAClDI,QAAAA,CAAC,CAACC,cAAF;AAEAC,QAAAA,gBAAU,CAACC,MAAX,CAAkBtB,SAAlB,EAA6BU,eAAe,CAACK,OAA7C;AACAQ,QAAAA,sBAAW,CAACC,KAAZ,CAAkBxB,SAAlB;;AAEA,YAAIO,aAAJ,EAAmB;AACjBkB,UAAAA,oBAAQ,CAAC5B,MAAD,EAAS;AAAE,aAACO,IAAD,GAAQG;AAAV,WAAT,CAAR;AACD;AACF;AACF;AAlBH,kBAoBEjB,wCAAC,WAAD;AAAa,IAAA,KAAK,EAAEiB,aAAa,IAAInB,KAArC;AAA4C,IAAA,WAAW,EAAEC;AAAzD,IApBF,CADF;AAwBD;;;;;"}