{"version":3,"file":"index.es.js","sources":["../src/ImageElement/ImageElement.styles.ts","../src/ImageElement/ImageHandle.tsx","../src/ImageElement/ImageElement.tsx","../src/ToolbarImage/ToolbarImage.tsx"],"sourcesContent":["import { createStyles } from '@udecode/plate-styled-components';\nimport { css } from 'styled-components';\nimport tw from 'twin.macro';\nimport { ImageElementStyleProps } from './ImageElement.types';\n\nexport const getImageElementStyles = (props: ImageElementStyleProps) => {\n  const {\n    focused,\n    selected,\n    align,\n    caption = {\n      align: 'center',\n    },\n  } = props;\n\n  const handle = [\n    tw`flex flex-col justify-center absolute select-none`,\n    tw`w-6 h-full top-0 z-10`,\n    css`\n      ::after {\n        ${tw`opacity-0`};\n        ${focused && selected && tw`opacity-100`};\n        ${tw`group-hover:opacity-100`};\n        ${tw`flex`};\n        ${tw`bg-gray-400`};\n\n        content: ' ';\n        width: 3px;\n        height: 64px;\n        border-radius: 6px;\n      }\n\n      :hover,\n      :focus,\n      :active {\n        ::after {\n          ${tw`bg-blue-500`};\n        }\n      }\n    `,\n  ];\n\n  return createStyles(\n    { prefixClassNames: 'ImageElement', ...props },\n    {\n      root: [tw`py-2.5`],\n      resizable: [\n        align === 'center' && tw`mx-auto`,\n        align === 'right' && tw`ml-auto`,\n      ],\n      figure: [tw`m-0 relative`],\n      img: [\n        tw`block max-w-full px-0 cursor-pointer w-full`,\n        tw`borderRadius[3px] object-cover`,\n        focused && selected && tw`boxShadow[0 0 0 1px rgb(59,130,249)]`,\n      ],\n      figcaption: [\n        align === 'center' && tw`mx-auto`,\n        align === 'right' && tw`ml-auto`,\n      ],\n      caption: [\n        tw`w-full border-none focus:outline-none mt-2 p-0 resize-none`,\n        caption?.align === 'center' && tw`text-center`,\n        caption?.align === 'right' && tw`text-right`,\n        css`\n          font: inherit;\n          color: inherit;\n          background-color: inherit;\n\n          :focus {\n            ::placeholder {\n              opacity: 0;\n            }\n          }\n        `,\n      ],\n      handleLeft: [...handle, tw`-left-3 -ml-3 pl-3`],\n      handleRight: [...handle, tw`items-end -right-3 -mr-3 pr-3`],\n    }\n  );\n};\n","import React from 'react';\nimport { CSSProp } from 'styled-components';\n\nexport interface ImageHandleProps\n  extends React.DetailedHTMLProps<\n    React.HTMLAttributes<HTMLDivElement>,\n    HTMLDivElement\n  > {\n  css?: CSSProp;\n  className?: string;\n}\n\nexport const ImageHandle = (props: ImageHandleProps) => <div {...props} />;\n","import React, {\n  ChangeEventHandler,\n  useCallback,\n  useEffect,\n  useMemo,\n  useState,\n} from 'react';\nimport TextareaAutosize from 'react-textarea-autosize';\nimport { setNodes } from '@udecode/plate-common';\nimport { useEditorRef } from '@udecode/plate-core';\nimport { Resizable } from 're-resizable';\nimport { Node, Transforms } from 'slate';\nimport { ReactEditor, useFocused, useSelected } from 'slate-react';\nimport { getImageElementStyles } from './ImageElement.styles';\nimport { ImageElementProps } from './ImageElement.types';\nimport { ImageHandle } from './ImageHandle';\n\n// const plugins = [\n//   createHistoryPlugin(),\n//   createReactPlugin(),\n//   createSingleLinePlugin(),\n// ];\n\nexport const ImageElement = (props: ImageElementProps) => {\n  const {\n    attributes,\n    children,\n    element,\n    nodeProps,\n    styles: _styles,\n    classNames,\n    prefixClassNames,\n    caption = {},\n    resizableProps = {\n      minWidth: 92,\n    },\n    align = 'center',\n    draggable,\n    ...rootProps\n  } = props;\n\n  const { placeholder = 'Write a caption...' } = caption;\n\n  const {\n    url,\n    width: nodeWidth = '100%',\n    caption: nodeCaption = [{ children: [{ text: '' }] }],\n  } = element;\n  const focused = useFocused();\n  const selected = useSelected();\n  const editor = useEditorRef();\n  const [width, setWidth] = useState(nodeWidth);\n\n  // const [captionId] = useState(nanoid());\n\n  useEffect(() => {\n    setWidth(nodeWidth);\n  }, [nodeWidth]);\n\n  const styles = getImageElementStyles({ ...props, align, focused, selected });\n\n  const setNodeWidth = useCallback(\n    (w: number) => {\n      const path = ReactEditor.findPath(editor, element);\n\n      if (w === nodeWidth) {\n        // Focus the node if not resized\n        Transforms.select(editor, path);\n      } else {\n        setNodes(editor, { width: w }, { at: path });\n      }\n    },\n    [editor, element, nodeWidth]\n  );\n\n  const onChangeCaption: ChangeEventHandler<HTMLTextAreaElement> = useCallback(\n    (e) => {\n      const path = ReactEditor.findPath(editor as ReactEditor, element);\n      setNodes(editor, { caption: [{ text: e.target.value }] }, { at: path });\n    },\n    [editor, element]\n  );\n\n  const captionString = useMemo(() => {\n    return Node.string(nodeCaption[0]) || '';\n  }, [nodeCaption]);\n\n  return (\n    <div\n      {...attributes}\n      css={styles.root.css}\n      className={styles.root.className}\n      {...rootProps}\n      {...nodeProps}\n    >\n      <div contentEditable={false}>\n        <figure\n          css={styles.figure?.css}\n          className={`group ${styles.figure?.className}`}\n        >\n          <Resizable\n            // @ts-ignore\n            css={styles.resizable?.css}\n            className={styles.resizable?.className}\n            size={{ width, height: '100%' }}\n            maxWidth=\"100%\"\n            lockAspectRatio\n            resizeRatio={align === 'center' ? 2 : 1}\n            enable={{\n              left: ['center', 'left'].includes(align),\n              right: ['center', 'right'].includes(align),\n            }}\n            handleComponent={{\n              left: (\n                <ImageHandle\n                  css={[styles.handleLeft?.css]}\n                  className={styles.handleLeft?.className}\n                />\n              ),\n              right: (\n                <ImageHandle\n                  css={styles.handleRight?.css}\n                  className={styles.handleRight?.className}\n                />\n              ),\n            }}\n            handleStyles={{\n              left: { left: 0 },\n              right: { right: 0 },\n            }}\n            onResize={(e, direction, ref) => {\n              setWidth(ref.offsetWidth);\n            }}\n            onResizeStop={(e, direction, ref) => setNodeWidth(ref.offsetWidth)}\n            {...resizableProps}\n          >\n            <img\n              data-testid=\"ImageElementImage\"\n              css={styles.img?.css}\n              className={styles.img?.className}\n              src={url}\n              alt={captionString}\n              draggable={draggable}\n              {...nodeProps}\n            />\n          </Resizable>\n\n          {!caption.disabled && (captionString.length || selected) && (\n            <figcaption\n              style={{ width }}\n              css={styles.figcaption?.css}\n              className={styles.figcaption?.className}\n            >\n              <TextareaAutosize\n                css={styles.caption?.css}\n                className={styles.caption?.className}\n                value={nodeCaption[0].text}\n                placeholder={placeholder}\n                onChange={onChangeCaption}\n              />\n\n              {/* <div css={styles.caption?.css}> */}\n              {/*  <Plate */}\n              {/*    id={captionId} */}\n              {/*    plugins={plugins} */}\n              {/*    initialValue={nodeCaption} */}\n              {/*    value={nodeCaption} */}\n              {/*    editableProps={{ */}\n              {/*      placeholder, */}\n              {/*      className: styles.caption?.className, */}\n              {/*    }} */}\n              {/*    onChange={onChangeCaption} */}\n              {/*  /> */}\n              {/* </div> */}\n            </figcaption>\n          )}\n        </figure>\n      </div>\n      {children}\n    </div>\n  );\n};\n","/* eslint-disable react/self-closing-comp */\nimport React from 'react';\nimport { useEventEditorId, useStoreEditorRef } from '@udecode/plate-core';\nimport { insertImage } from '@udecode/plate-image';\nimport { ToolbarButton, ToolbarButtonProps } from '@udecode/plate-toolbar';\n\nexport interface ToolbarImageProps extends ToolbarButtonProps {\n  /**\n   * Default onMouseDown is getting the image url by calling this promise before inserting the image.\n   */\n  getImageUrl?: () => Promise<string>;\n}\n\nexport const ToolbarImage = ({ getImageUrl, ...props }: ToolbarImageProps) => {\n  let url;\n  const editor = useStoreEditorRef(useEventEditorId('focus'));\n\n  const handleUploadImage = async (e: any) => {\n    const formData = new FormData();\n    formData.append('File', e.currentTarget.files[0]);\n    const res = await fetch('/api/file/uploadFile', {\n      method: 'POST',\n      body: formData,\n    });\n    const resJson = await res.json();\n    return `https://blur-image.sfo3.digitaloceanspaces.com/${resJson.image}`;\n  };\n\n  return (\n    <ToolbarButton\n      onMouseDown={async (event) => {\n        if (!editor) return;\n\n        event.preventDefault();\n      }}\n      {...props}\n    >\n      <input\n        id=\"file-ul\"\n        type=\"file\"\n        accept=\"image/*\"\n        style={{ display: 'none' }}\n        onClick={async (e) => {\n          if (!editor) return;\n          e.preventDefault();\n          url = await handleUploadImage(e);\n          if (!url) return;\n          insertImage(editor, url);\n        }}\n      />\n    </ToolbarButton>\n  );\n};\n"],"names":["getImageElementStyles","props","focused","selected","align","caption","handle","css","createStyles","prefixClassNames","root","resizable","figure","img","figcaption","handleLeft","handleRight","ImageHandle","ImageElement","attributes","children","element","nodeProps","styles","_styles","classNames","resizableProps","minWidth","draggable","rootProps","placeholder","url","width","nodeWidth","nodeCaption","text","useFocused","useSelected","editor","useEditorRef","setWidth","useState","useEffect","setNodeWidth","useCallback","w","path","ReactEditor","findPath","Transforms","select","setNodes","at","onChangeCaption","e","target","value","captionString","useMemo","Node","string","className","height","left","includes","right","direction","ref","offsetWidth","disabled","length","ToolbarImage","getImageUrl","useStoreEditorRef","useEventEditorId","handleUploadImage","formData","FormData","append","currentTarget","files","res","fetch","method","body","resJson","json","image","event","preventDefault","display","insertImage"],"mappings":"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"}